{% extends 'builder/base.html' %} {% load static %} {% block title %}Create Your
CV - Enhanced{% endblock %} {% block content %}
<div class="container-fluid">
  <div class="row">
    <!-- Progress Sidebar -->
    <div class="col-md-3 d-none d-md-block">
      <div class="sticky-top pt-3">
        <h5>CV Progress</h5>
        <div class="progress mb-3">
          <div
            class="progress-bar"
            role="progressbar"
            style="width: 0%"
            id="progress-bar"
          >
            0%
          </div>
        </div>
        <ul class="nav nav-pills flex-column">
          <li class="nav-item">
            <a class="nav-link active" href="#personal-info">Personal Info</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#experience">Experience</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#education">Education</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#skills">Skills</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#languages">Languages</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#certifications">Certifications</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#template">Template</a>
          </li>
        </ul>
      </div>
    </div>

    <div class="col-md-9">
      <h1>Create Your Professional CV</h1>
      <p class="text-muted">Fill in your details to create a stunning CV</p>

      {% if templates %}
      <form
        method="POST"
        action="{% url 'builder:create_cv' %}"
        id="cv-form"
        novalidate
      >
        {% csrf_token %}

        <!-- Personal Information Section -->
        <div class="card mb-4" id="personal-info">
          <div class="card-header">
            <h3>Personal Information</h3>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="full_name" class="form-label">Full Name *</label>
                <input
                  type="text"
                  class="form-control"
                  id="full_name"
                  name="full_name"
                  value="{{ user_data.full_name|default:'' }}"
                  required
                  pattern="^[a-zA-Z\s\-']{2,50}$"
                  data-bs-toggle="tooltip"
                  title="Enter your full legal name"
                />
                <div class="invalid-feedback">
                  Please enter a valid name (2-50 characters, letters only)
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="email" class="form-label">Email Address *</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  name="email"
                  value="{{ user_data.email|default:'' }}"
                  required
                  pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$"
                />
                <div class="invalid-feedback">
                  Please enter a valid email address
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="phone" class="form-label">Phone Number *</label>
                <input
                  type="tel"
                  class="form-control"
                  id="phone"
                  name="phone"
                  value="{{ user_data.phone|default:'' }}"
                  required
                  pattern="^\+?[\d\s\-\(\)]{10,20}$"
                  placeholder="+1 (555) 123-4567"
                />
                <div class="invalid-feedback">
                  Please enter a valid phone number
                </div>
              </div>
              <div class="col-md-6 mb-3">
                <label for="location" class="form-label">Location *</label>
                <input
                  type="text"
                  class="form-control"
                  id="location"
                  name="location"
                  value="{{ user_data.location|default:'' }}"
                  required
                  placeholder="City, State, Country"
                />
                <div class="invalid-feedback">Please enter your location</div>
              </div>
            </div>

            <div class="mb-3">
              <label for="summary" class="form-label"
                >Professional Summary *</label
              >
              <textarea
                class="form-control"
                id="summary"
                name="summary"
                rows="4"
                placeholder="Write a compelling summary of your professional background..."
                maxlength="500"
                required
              >
{{ user_data.summary|default:'' }}</textarea
              >
              <div class="form-text">
                <span id="summary-count">0</span>/500 characters
              </div>
              <div class="invalid-feedback">
                Please provide a professional summary (max 500 characters)
              </div>
            </div>

            <div class="mb-3">
              <label for="linkedin" class="form-label"
                >LinkedIn Profile (Optional)</label
              >
              <input
                type="url"
                class="form-control"
                id="linkedin"
                name="linkedin"
                placeholder="https://linkedin.com/in/yourprofile"
              />
            </div>

            <div class="mb-3">
              <label for="portfolio" class="form-label"
                >Portfolio/Website (Optional)</label
              >
              <input
                type="url"
                class="form-control"
                id="portfolio"
                name="portfolio"
                placeholder="https://yourportfolio.com"
              />
            </div>
          </div>
        </div>

        <!-- Work Experience Section -->
        <div class="card mb-4" id="experience">
          <div
            class="card-header d-flex justify-content-between align-items-center"
          >
            <h3>Work Experience</h3>
            <span class="badge bg-secondary" id="experience-count"
              >0 entries</span
            >
          </div>
          <div class="card-body">
            <div id="experience-container">
              <!-- Dynamic experience entries will be added here -->
            </div>
            <button
              type="button"
              class="btn btn-outline-primary"
              onclick="addExperience()"
            >
              <i class="fas fa-plus"></i> Add Experience
            </button>
          </div>
        </div>

        <!-- Education Section -->
        <div class="card mb-4" id="education">
          <div
            class="card-header d-flex justify-content-between align-items-center"
          >
            <h3>Education</h3>
            <span class="badge bg-secondary" id="education-count"
              >0 entries</span
            >
          </div>
          <div class="card-body">
            <div id="education-container">
              <!-- Dynamic education entries will be added here -->
            </div>
            <button
              type="button"
              class="btn btn-outline-primary"
              onclick="addEducation()"
            >
              <i class="fas fa-plus"></i> Add Education
            </button>
          </div>
        </div>

        <!-- Skills Section -->
        <div class="card mb-4" id="skills">
          <div class="card-header">
            <h3>Skills</h3>
          </div>
          <div class="card-body">
            <div class="mb-3">
              <label for="skills-input" class="form-label"
                >Add your skills (comma-separated)</label
              >
              <input
                type="text"
                class="form-control"
                id="skills-input"
                placeholder="e.g., Python, JavaScript, Project Management"
              />
            </div>
            <div id="skills-container" class="d-flex flex-wrap gap-2">
              <!-- Dynamic skill tags will be added here -->
            </div>
          </div>
        </div>

        <!-- Languages Section -->
        <div class="card mb-4" id="languages">
          <div
            class="card-header d-flex justify-content-between align-items-center"
          >
            <h3>Languages</h3>
            <span class="badge bg-secondary" id="language-count"
              >0 entries</span
            >
          </div>
          <div class="card-body">
            <div id="language-container">
              <!-- Dynamic language entries will be added here -->
            </div>
            <button
              type="button"
              class="btn btn-outline-primary"
              onclick="addLanguage()"
            >
              <i class="fas fa-plus"></i> Add Language
            </button>
          </div>
        </div>

        <!-- Certifications Section -->
        <div class="card mb-4" id="certifications">
          <div
            class="card-header d-flex justify-content-between align-items-center"
          >
            <h3>Certifications</h3>
            <span class="badge bg-secondary" id="certification-count"
              >0 entries</span
            >
          </div>
          <div class="card-body">
            <div id="certification-container">
              <!-- Dynamic certification entries will be added here -->
            </div>
            <button
              type="button"
              class="btn btn-outline-primary"
              onclick="addCertification()"
            >
              <i class="fas fa-plus"></i> Add Certification
            </button>
          </div>
        </div>

        <!-- Template Selection -->
        <div class="card mb-4" id="template">
          <div class="card-header">
            <h3>Choose a Template</h3>
          </div>
          <div class="card-body">
            <div class="row">
              {% for template in templates %}
              <div class="col-md-4 mb-3">
                <div class="template-card" data-template-id="{{ template.id }}">
                  <img
                    src="{{ template.preview_image.url }}"
                    class="img-fluid rounded"
                    alt="{{ template.name }}"
                  />
                  <div class="template-overlay">
                    <h5>{{ template.name }}</h5>
                    <p>{{ template.description }}</p>
                  </div>
                </div>
              </div>
              {% endfor %}
            </div>
            <input type="hidden" name="template_id" id="template_id" />
          </div>
        </div>

        <div class="d-grid">
          <button type="submit" class="btn btn-primary btn-lg">
            Generate CV
          </button>
        </div>
      </form>
      {% else %}
      <div class="alert alert-warning">
        <strong>No templates available.</strong> Please check back later or
        contact support.
      </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Modal for editing sections -->
<div
  class="modal fade"
  id="section-modal"
  tabindex="-1"
  aria-labelledby="section-modal-label"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="section-modal-label">Edit Section</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <!-- Form fields for sections will be injected here -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <button type="button" class="btn btn-primary" id="save-section-btn">
          Save changes
        </button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'builder/js/create_cv_enhanced.js' %}"></script>
{% endblock %}
