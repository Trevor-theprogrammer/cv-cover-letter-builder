{% extends 'builder/base.html' %} {% load static %} {% block title %}GlowUp CV - Your AI CV Makeover Tool{% endblock %} {% block content %}

<div class="glowup-container">
  <!-- Header -->
  <header class="glowup-header">
    <h1 class="glowup-title">GlowUp CV</h1>
    <p class="glowup-subtitle">Your AI CV Makeover Tool</p>
  </header>

  <!-- Progress Steps -->
  <div class="glowup-steps">
    <div class="step active" data-step="1">
      <div class="step-circle">1</div>
      <div class="step-label">Choose Template</div>
    </div>
    <div class="step" data-step="2">
      <div class="step-circle">2</div>
      <div class="step-label">Upload CV</div>
    </div>
    <div class="step" data-step="3">
      <div class="step-circle">3</div>
      <div class="step-label">Verify Content</div>
    </div>
    <div class="step" data-step="4">
      <div class="step-circle">4</div>
      <div class="step-label">Preview</div>
    </div>
    <div class="step" data-step="5">
      <div class="step-circle">5</div>
      <div class="step-label">Download</div>
    </div>
  </div>

  <!-- Step 1: Choose Template -->
  <div class="step-content active" id="step-1">
    <h2 class="step-title">Choose Your Professional Template</h2>
    <p class="step-description">Select from our curated collection of modern, ATS-friendly templates</p>
    
    <div class="template-grid">
      {% for template in templates %}
      <div class="template-card-glowup" data-template-id="{{ template.id }}">
        <div class="template-preview">
          <img src="{{ template.preview_image.url }}" alt="{{ template.name }}" class="template-image">
          <div class="template-overlay">
            <button class="btn-preview">Preview</button>
            <button class="btn-select">Select</button>
          </div>
        </div>
        <h3 class="template-name">{{ template.name }}</h3>
        <p class="template-description">{{ template.description|default:"Professional template optimized for your industry" }}</p>
      </div>
      {% empty %}
      <div class="no-templates">
        <i class="fas fa-file-alt"></i>
        <h3>No Templates Available</h3>
        <p>Please check back later or contact support</p>
      </div>
      {% endfor %}
    </div>
    
    <div class="step-navigation">
      <button type="button" class="btn-next" onclick="nextStep(2)">Continue to Upload</button>
    </div>
  </div>

  <!-- Step 2: Upload CV -->
  <div class="step-content" id="step-2">
    <h2 class="step-title">Upload Your Existing CV</h2>
    <p class="step-description">We'll extract your information and enhance it with AI</p>
    
    <div class="upload-section">
      <div class="upload-zone" id="upload-zone">
        <i class="fas fa-cloud-upload-alt"></i>
        <h3>Drag & Drop Your CV</h3>
        <p>or <button type="button" class="btn-upload">browse files</button></p>
        <small>Supports PDF, DOC, DOCX</small>
      </div>
      <input type="file" id="cv-upload" accept=".pdf,.doc,.docx" style="display: none;">
    </div>
    
    <div class="step-navigation">
      <button type="button" class="btn-prev" onclick="prevStep(1)">Back</button>
      <button type="button" class="btn-next" onclick="nextStep(3)">Continue</button>
    </div>
  </div>

  <!-- Step 3: Verify Content -->
  <div class="step-content" id="step-3">
    <h2 class="step-title">Verify Your Information</h2>
    <p class="step-description">Review and edit the extracted information</p>
    
    <form method="POST" action="{% url 'builder:create_cv' %}" id="cv-form" class="glowup-form">
      {% csrf_token %}
      
      <!-- Personal Information -->
      <div class="form-section">
        <h3>Personal Information</h3>
        <div class="form-grid">
          <div class="form-group">
            <label for="full_name">Full Name</label>
            <input type="text" name="full_name" id="full_name" class="form-control" value="{{ user_data.full_name|default:'' }}" required>
          </div>
          <div class="form-group">
            <label for="email">Email Address</label>
            <input type="email" name="email" id="email" class="form-control" value="{{ user_data.email|default:'' }}" required>
          </div>
          <div class="form-group">
            <label for="phone">Phone Number</label>
            <input type="tel" name="phone" id="phone" class="form-control" value="{{ user_data.phone|default:'' }}">
          </div>
          <div class="form-group">
            <label for="location">Location</label>
            <input type="text" name="location" id="location" class="form-control" value="{{ user_data.location|default:'' }}" placeholder="City, Country">
          </div>
        </div>
      </div>

      <!-- Professional Summary -->
      <div class="form-section">
        <h3>Professional Summary</h3>
        <div class="form-group">
          <label for="summary">Summary</label>
          <textarea name="summary" id="summary" class="form-control" rows="4" placeholder="Write a brief summary...">{{ user_data.summary|default:'' }}</textarea>
          <small class="character-count"><span id="summary-count">0</span> characters</small>
        </div>
      </div>

      <!-- Work Experience -->
      <div class="form-section">
        <h3>Work Experience</h3>
        <div id="experience-container">
          <!-- Dynamic entries will be added here -->
        </div>
        <button type="button" class="btn-add" onclick="addExperience()">
          <i class="fas fa-plus"></i> Add Experience
        </button>
      </div>

      <!-- Education -->
      <div class="form-section">
        <h3>Education</h3>
        <div id="education-container">
          <!-- Dynamic entries will be added here -->
        </div>
        <button type="button" class="btn-add" onclick="addEducation()">
          <i class="fas fa-plus"></i> Add Education
        </button>
      </div>

      <!-- Projects -->
      <div class="form-section">
        <h3>Projects</h3>
        <div id="projects-container">
          <!-- Dynamic entries will be added here -->
        </div>
        <button type="button" class="btn-add" onclick="addProject()">
          <i class="fas fa-plus"></i> Add Project
        </button>
      </div>

      <!-- Skills -->
      <div class="form-section">
        <h3>Skills</h3>
        <div class="form-group">
          <label for="skills-input">Add Skills</label>
          <input type="text" id="skills-input" class="form-control" placeholder="Type a skill and press Enter">
          <div id="skills-container" class="skills-tags"></div>
        </div>
      </div>

      <input type="hidden" name="template_id" id="template_id" required>
      
      <div class="step-navigation">
        <button type="button" class="btn-prev" onclick="prevStep(2)">Back</button>
        <button type="button" class="btn-next" onclick="nextStep(4)">Preview CV</button>
      </div>
    </form>
  </div>

  <!-- Step 4: Preview -->
  <div class="step-content" id="step-4">
    <h2 class="step-title">Preview Your CV</h2>
    <p class="step-description">See how your CV looks with the selected template</p>
    
    <div class="preview-container">
      <div class="preview-sidebar">
        <h3>CV Preview</h3>
        <p>Your information will appear here once processed</p>
      </div>
      <div class="preview-main">
        <div class="cv-preview-frame">
          <iframe id="cv-preview" src="" frameborder="0"></iframe>
        </div>
      </div>
    </div>
    
    <div class="step-navigation">
      <button type="button" class="btn-prev" onclick="prevStep(3)">Back to Edit</button>
      <button type="button" class="btn-next" onclick="nextStep(5)">Download CV</button>
    </div>
  </div>

  <!-- Step 5: Download -->
  <div class="step-content" id="step-5">
    <h2 class="step-title">Download Your CV</h2>
    <p class="step-description">Your professional CV is ready!</p>
    
    <div class="download-section">
      <div class="download-card">
        <i class="fas fa-check-circle success-icon"></i>
        <h3>CV Generated Successfully!</h3>
        <p>Your CV has been processed and is ready for download</p>
        
        <div class="download-options">
          <button type="submit" class="btn-download primary">
            <i class="fas fa-download"></i>
            Download PDF
          </button>
          <button type="button" class="btn-download secondary">
            <i class="fas fa-file-word"></i>
            Download DOCX
          </button>
        </div>
        
        <div class="share-options">
          <p>Share your CV:</p>
          <button class="btn-share linkedin">
            <i class="fab fa-linkedin"></i>
            LinkedIn
          </button>
          <button class="btn-share email">
            <i class="fas fa-envelope"></i>
            Email
          </button>
        </div>
      </div>
    </div>
    
    <div class="step-navigation">
      <button type="button" class="btn-prev" onclick="prevStep(4)">Back to Preview</button>
      <button type="button" class="btn-create-new" onclick="resetForm()">Create Another CV</button>
    </div>
  </div>
</div>

<!-- CSS Styles -->
<style>
  :root {
    --primary-green: #10b981;
    --primary-green-dark: #059669;
    --accent-green: #34d399;
    --text-dark: #1f2937;
    --text-light: #6b7280;
    --bg-light: #f9fafb;
    --border-light: #e5e7eb;
  }

  .glowup-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .glowup-header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .glowup-title {
    font-size: 3rem;
    font-weight: 700;
    color: var(--primary-green);
    margin-bottom: 0.5rem;
  }

  .glowup-subtitle {
    font-size: 1.25rem;
    color: var(--text-light);
  }

  .glowup-steps {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 3rem;
    gap: 2rem;
    flex-wrap: wrap;
  }

  .step {
    display: flex;
    flex-direction: column;
    align-items: center;
    opacity: 0.5;
    transition: opacity 0.3s ease;
  }

  .step.active {
    opacity: 1;
  }

  .step-circle {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--primary-green);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.25rem;
    margin-bottom: 0.5rem;
  }

  .step-label {
    font-size: 0.875rem;
    color: var(--text-dark);
    text-align: center;
  }

  .step-content {
    display: none;
  }

  .step-content.active {
    display: block;
  }

  .step-title {
    font-size: 2rem;
    color: var(--text-dark);
    margin-bottom: 0.5rem;
  }

  .step-description {
    color: var(--text-light);
    margin-bottom: 2rem;
  }

  .template-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .template-card-glowup {
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
  }

  .template-card-glowup:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 25px rgba(16, 185, 129, 0.15);
  }

  .template-preview {
    position: relative;
    overflow: hidden;
  }

  .template-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
  }

  .template-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(16, 185, 129, 0.9);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .template-card-glowup:hover .template-overlay {
    opacity: 1;
  }

  .btn-preview, .btn-select {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    transition: transform 0.2s ease;
  }

  .btn-preview {
    background: white;
    color: var(--primary-green);
  }

  .btn-select {
    background: var(--primary-green-dark);
    color: white;
  }

  .template-name {
    padding: 1rem;
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--text-dark);
  }

  .template-description {
    padding: 0 1rem 1rem;
    color: var(--text-light);
    font-size: 0.875rem;
  }

  .upload-section {
    margin-bottom: 2rem;
  }

  .upload-zone {
    border: 2px dashed var(--border-light);
    border-radius: 12px;
    padding: 3rem;
    text-align: center;
    background: var(--bg-light);
    transition: border-color 0.3s ease;
  }

  .upload-zone:hover {
    border-color: var(--primary-green);
  }

  .upload-zone i {
    font-size: 3rem;
    color: var(--primary-green);
    margin-bottom: 1rem;
  }

  .btn-upload {
    background: none;
    border: none;
    color: var(--primary-green);
    font-weight: 500;
    cursor: pointer;
    text-decoration: underline;
  }

  .form-section {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .form-section h3 {
    color: var(--text-dark);
    margin-bottom: 1.5rem;
  }

  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
  }

  .form-group {
    margin-bottom: 1rem;
  }

  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: var(--text-dark);
  }

  .form-control {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--border-light);
    border-radius: 6px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }

  .form-control:focus {
    outline: none;
    border-color: var(--primary-green);
  }

  .btn-add {
    background: var(--primary-green);
    color: white;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.3s ease;
  }

  .btn-add:hover {
    background: var(--primary-green-dark);
  }

  .skills-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-top: 0.5rem;
  }

  .character-count {
    color: var(--text-light);
    font-size: 0.875rem;
  }

  .step-navigation {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 2rem;
    gap: 1rem;
  }

  .btn-prev, .btn-next {
    padding: 0.75rem 2rem;
    border: none;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .btn-prev {
    background: var(--bg-light);
    color: var(--text-dark);
    border: 1px solid var(--border-light);
  }

  .btn-next {
    background: var(--primary-green);
    color: white;
  }

  .btn-prev:hover {
    background: var(--border-light);
  }

  .btn-next:hover {
    background: var(--primary-green-dark);
  }

  .preview-container {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 2rem;
    margin-bottom: 2rem;
  }

  .preview-sidebar {
    background: white;
    border-radius: 12px;
    padding: 2rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .cv-preview-frame {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    overflow: hidden;
  }

  .cv-preview-frame iframe {
    width: 100%;
    height: 600px;
    border: none;
  }

  .download-section {
    text-align: center;
  }

  .download-card {
    background: white;
    border-radius: 12px;
    padding: 3rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    max-width: 500px;
    margin: 0 auto;
  }

  .success-icon {
    font-size: 4rem;
    color: var(--primary-green);
    margin-bottom: 1rem;
  }

  .download-options {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin: 2rem 0;
  }

  .btn-download {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 6px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .btn-download.primary {
    background: var(--primary-green);
    color: white;
  }

  .btn-download.secondary {
    background: var(--bg-light);
    color: var(--text-dark);
    border: 1px solid var(--border-light);
  }

  .share-options {
    margin-top: 2rem;
  }

  .btn-share {
    padding: 0.5rem 1rem;
    margin: 0 0.5rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.875rem;
  }

  .btn-share.linkedin {
    background: #0077b5;
    color: white;
  }

  .btn-share.email {
    background: #ea4335;
    color: white;
  }

  @media (max-width: 768px) {
    .glowup-container {
      padding: 1rem;
    }

    .glowup-title {
      font-size: 2rem;
    }

    .glowup-steps {
      flex-direction: column;
      gap: 1rem;
    }

    .template-grid {
      grid-template-columns: 1fr;
    }

    .form-grid {
      grid-template-columns: 1fr;
    }

    .preview-container {
      grid-template-columns: 1fr;
    }

    .download-options {
      flex-direction: column;
    }
  }
</style>

<script src="{% static 'builder/js/create_cv_enhanced.js' %}"></script>
<script>
  // Step navigation functionality
  function nextStep(step) {
    // Hide current step
    document.querySelectorAll('.step-content').forEach(content => {
      content.classList.remove('active');
    });
    
    // Show next step
    document.getElementById(`step-${step}`).classList.add('active');
    
    // Update progress
    document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
    document.querySelector(`.step[data-step="${step}"]`).classList.add('active');
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function prevStep(step) {
    nextStep(step);
  }

  function resetForm() {
    // Reset form and go to step 1
    document.getElementById('cv-form').reset();
    nextStep(1);
  }

  // Template selection
  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.template-card-glowup').forEach(card => {
      card.addEventListener('click', function() {
        document.querySelectorAll('.template-card-glowup').forEach(c => c.classList.remove('selected'));
        this.classList.add('selected');
        document.getElementById('template_id').value = this.dataset.templateId;
      });
    });

    // File upload handling
    const uploadZone = document.getElementById('upload-zone');
    const fileInput = document.getElementById('cv-upload');
    
    uploadZone.addEventListener('click', () => fileInput.click());
    
    fileInput.addEventListener('change', (e) => {
      if (e.target.files.length > 0) {
        uploadZone.innerHTML = `
          <i class="fas fa-file-check"></i>
          <h3>${e.target.files[0].name}</h3>
          <p>File uploaded successfully!</p>
        `;
      }
    });
  });
</script>

{% endblock %}
